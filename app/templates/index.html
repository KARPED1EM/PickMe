<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pick Me</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', path='icons/icon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='css/style.css') }}">
</head>
<body class="app-body">
<div class="app-backdrop"></div>
<main class="app-main container-xxl px-3 px-lg-4 py-4">
    <div class="app-grid">
        <div class="app-primary">
        <section class="glass result-card p-4">
            <div class="result-grid">
            <div class="result-main">
                <div class="result-primary">
                <div id="result-name" class="result-name">--</div>
                <div id="result-note" class="result-note">等待抽取...</div>
                </div>
            </div>
            <div class="result-side">
                <div class="result-meta">
                <button id="class-switcher" type="button" class="btn btn-ghost class-switcher">
                    <span class="class-switcher-label" id="class-switcher-label">--</span>
                    <span class="class-switcher-icon" aria-hidden="true">
                    <svg viewBox="0 0 16 16" fill="none">
                        <path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                    </span>
                </button>
                <div class="result-stats">
                    <div class="result-stat">
                    <span class="result-stat-label">总人数</span>
                    <span id="stat-total" class="result-stat-value">0</span>
                    </div>
                    <div class="result-stat">
                    <span class="result-stat-label">冷却中</span>
                    <span id="stat-cooling" class="result-stat-value">0</span>
                    </div>
                    <div class="result-stat">
                    <span class="result-stat-label">可抽取</span>
                    <span id="stat-available" class="result-stat-value">0</span>
                    </div>
                </div>
                </div>
                <div class="result-controls-wrapper">
                <div class="controls-left">
                    <div class="batch-count-field d-none" data-batch-field>
                    <label class="form-label" for="batch-count">抽取人数</label>
                    <div class="input-group input-group-sm batch-input">
                        <input id="batch-count" type="number" class="form-control" min="1" step="1" autocomplete="off" inputmode="numeric">
                        <span class="input-group-text">人</span>
                    </div>
                    </div>
                </div>
                <div class="controls-right">
                    <div class="result-controls">
                    <div class="form-check form-switch ignore-switch switch-ghost">
                        <input class="form-check-input" type="checkbox" id="ignore-cooldown">
                        <label class="form-check-label" for="ignore-cooldown">忽略冷却时间</label>
                    </div>
                    <div class="result-action">
                        <div class="result-action-split result-mode-control" data-mode-control>
                        <button id="pick-action" type="button" class="btn btn-accent result-action-button">
                            <span class="result-action-text">抽取</span>
                            <span id="result-mode-display" class="result-action-mode">抽取一人</span>
                        </button>
                        <button id="pick-mode-toggle" type="button" class="btn btn-accent result-action-toggle" aria-haspopup="true" aria-expanded="false" aria-controls="result-mode-menu">
                            <span class="result-action-icon" aria-hidden="true">
                            <svg viewBox="0 0 16 16" fill="none">
                                <path d="M5 6l3 4 3-4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
                            </svg>
                            </span>
                        </button>
                        </div>
                        <div id="result-mode-menu" class="result-mode-menu" hidden>
                        <button type="button" class="result-mode-option" data-mode-value="any" data-mode-label="抽取一人">抽取一人</button>
                        <button type="button" class="result-mode-option" data-mode-value="batch" data-mode-label="抽取多人">抽取多人</button>
                        <button type="button" class="result-mode-option" data-mode-value="group" data-mode-label="抽取小组">抽取小组</button>
                        </div>
                    </div>
                    </div>
                </div>
                </div>
            </div>
            </div>
        </section>

        <div class="app-lists">
            <section class="list-section">
            <div class="glass list-card p-4 h-100">
                <div class="list-header">
                <div>
                    <h2 class="list-title">全部学生</h2>
                    <p class="list-subtitle">右键列表项可以快速操作</p>
                </div>
                <div class="list-toolbar">
                    <div class="search-box">
                    <span class="search-icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none">
                        <path d="M21 21l-4.35-4.35M19 11a8 8 0 1 1-16 0 8 8 0 0 1 16 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                        </svg>
                    </span>
                    <input id="student-search" type="search" class="form-control" placeholder="搜索姓名 / 小组" autocomplete="off">
                    </div>
                    <button id="add-student" class="btn btn-outline-light btn-sm toolbar-btn">添加学生</button>
                </div>
                </div>
                <ul id="student-list" class="student-list slim-scroll"></ul>
            </div>
            </section>
            <section class="list-section">
            <div class="glass list-card p-4 h-100">
                <div class="list-header">
                <div>
                    <h2 class="list-title">冷却队列</h2>
                    <p class="list-subtitle">右键列表项可以快速操作</p>
                </div>
                <div class="cooldown-toolbar">
                    <button id="cooldown-display" type="button" class="btn btn-ghost btn-sm">
                    冷却 <span id="cooldown-value">0</span> 天
                    </button>
                    <button id="clear-cooldown" class="btn btn-ghost btn-sm">清空冷却</button>
                </div>
                </div>
                <ul id="cooldown-list" class="student-list slim-scroll"></ul>
            </div>
            </section>
        </div>
        </div>

        <aside class="app-history">
        <section class="glass history-card p-4 h-100">
            <div class="list-header history-header">
            <div>
                <h2 class="list-title">点名历史</h2>
                <p class="list-subtitle">右键列表项可以快速操作</p>
            </div>
            </div>
            <div id="history-list" class="history-panel slim-scroll">
            <div class="history-empty" data-history-empty>暂无历史记录</div>
            <div id="history-groups" class="history-groups"></div>
            </div>
        </section>
        </aside>
    </div>
</main>

<div id="context-menu" class="context-menu d-none"></div>
<div id="modal-root" class="modal-root d-none"></div>
<div id="toast" class="toast glass text-bg-dark"></div>
<div class="user-data-path" title="{{ user_data_path }}">
    数据存储：<span>{{ user_data_path }}</span>
</div>

<script>
    window.__APP_INITIAL_DATA__ = {{ initial_data|safe }};
    window.__APP_STORAGE_MODE__ = {{ storage_mode|tojson }};
    window.__APP_STORAGE_LOCATION__ = {{ user_data_path|tojson }};
</script>
<script src="{{ url_for('static', path='js/app.js') }}"></script>
</body>
</html>
